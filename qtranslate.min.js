function qtranxj_get_cookie(e){for(var a=e+"=",n=document.cookie.split(";"),t=0;t<n.length;t++){var i=n[t],r=i.indexOf(a);if(r>=0)return i.substring(r+a.length,i.length)}return""}function qtranxj_isArray(e){return e.constructor.toString().indexOf("Array")>=0}function ce(e,a,n,t){var i=document.createElement(e);if(a)for(prop in a)i[prop]=a[prop];return n&&(t&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i)),i}function c(e){++cc,console.log("== "+cc+": "+e)}function ct(e){c(e),console.trace()}function ge(e){return document.getElementById(e)}function LanguageSwitch(e,a){function n(){var e=this;if(!e.lang)return void alert("qTranslate-X: This should not have happened: Please, report this incident to the developers: !tabSwitch.lang");if(r!==e.lang){r&&l[r].classList.remove("active"),r=e.lang,e.classList.add("active");for(var a=0;a<g.length;a++)g[a].call(this)}}for(var t=qTranslateConfig.enabled_languages,i=qTranslateConfig.language_name,r=a,l={},g=[],o=0;o<t.length;o++){var s=t[o],c=ce("li",{lang:s,className:"qtranxs-lang-switch",onclick:n},e);ce("img",{src:"/wp-content/"+qTranslateConfig.flag_location+qTranslateConfig.flag[s]},c),ce("span",{innerHTML:i[s]},c),l[s]=c,r==s&&c.classList.add("active")}this.getActiveLanguage=function(){return r},this.onSwitch=function(e){"function"==typeof e&&g.push(e)}}qtranxj_split=function(e){for(var a=/(<!--.*?-->)/gi,n=/<!--:([a-z]{2})-->/gi,t=/<!--:-->/gi,i=/(<!--more-->|<!--nextpage-->)+$/gi,r=null,l=new Object,g=!1,o=0;o<qTranslateConfig.enabled_languages.length;o++){var s=qTranslateConfig.enabled_languages[o];l[s]=""}var c=e.xsplit(a);if(qtranxj_isArray(c))for(var o=0;o<c.length;o++)if(null!=(r=n.exec(c[o])))g=r[1];else if(t.test(c[o]))g=!1;else if(g)l[g]+=c[o];else for(var u=0;u<qTranslateConfig.enabled_languages.length;u++){var s=qTranslateConfig.enabled_languages[u];l[s]+=c[o]}for(var o=0;o<l.length;o++)l[o]=l[o].replace(i,"");return l},qtranxj_join=function(e){for(var a="",n=0;n<qTranslateConfig.enabled_languages.length;n++){var t=qTranslateConfig.enabled_languages[n],i=e[t];i&&""!=i&&(a+="<!--:"+t+"-->",a+=i,a+="<!--:-->")}return a},String.prototype.xsplit=function(e){if(3==="a~b".split(/(~)/).length)return this.split(e);e.global||(e=new RegExp(e.source,"g"+(e.ignoreCase?"i":"")));for(var a,n=0,t=[];null!=(a=e.exec(this));)t.push(this.slice(n,a.index)),a.length>1&&t.push(a[1]),n=e.lastIndex;return n<this.length&&t.push(this.slice(n)),n==this.length&&t.push(""),t};var cc=0,qTranslateX=function(){function e(e,a,n,t){var i=/(<!--more-->|<!--nextpage-->)+$/gi;n[t]=a.replace(i,""),e.value=qtranxj_join(n)}function a(){var e,a,n=!!ge("tag-name");n?(e="tag-",a="addtag"):(e="",a="edittag");var i=ge(e+"name"),r=ge(a);if(!r||!i)return!1;build_translator=function(e,a){var n={};for(var t in qTranslateConfig.term_name){var i=qTranslateConfig.term_name[t],r=i[e],l=i[a];if(!r||!l){var g=i[qTranslateConfig.default_language];if(!g)continue;r||(r=g+"("+qTranslateConfig.default_language+")"),l||(l=g+"("+qTranslateConfig.default_language+")")}n[r]=l}return n};var l=ge("the-list");(updateNames=function(e,a){if(l)for(var n=l.getElementsByTagName("TR"),t=0;t<n.length;t++){for(var i,r=n[t],g=r.getElementsByTagName("TD")[0],o=g.getElementsByTagName("DIV"),s=0;s<o.length;s++){var c=o[s];if("name"===c.className){i=c.innerHTML;break}}for(var u=qTranslateConfig.term_name[i]||{},h=u[e]||"",f=u[a]||"",d=g.getElementsByClassName("row-title"),v=0;v<d.length;v++){var c=d[v];h?c.innerHTML=c.innerHTML.replace(h,f):c.innerHTML+=f}}})(qTranslateConfig.default_language,t);var g=document.getElementsByClassName("tagcloud")[0];(updateTagCloud=function(e,a){if(g){var n=g.getElementsByTagName("A");if(n.length)for(var t=build_translator(e,a),i=0;i<n.length;i++){var r=n[i],l=r.innerHTML,o=t[l];o&&(r.innerHTML=o)}}})(qTranslateConfig.default_language,t);var o=ce("input",{name:i.name,className:"hidden",value:i.value},r,!0);i.name="";var s=qTranslateConfig.term_name[i.value]||{};t!==qTranslateConfig.default_language&&(i.value=s[t]||""),editinline_activated=function(){return c("editinline_activated:"+this.innerHTML),!0};var u=document.getElementsByClassName("editinline");c("editinlines.length="+u.length);for(var h=0;h<u.length;h++){var f=u[h];"A"===f.tagName&&f.addEventListener("click",editinline_activated)}onTabSwitch=function(){t!==this.lang&&(i.value=s[this.lang]||"",updateNames(t,this.lang),updateTagCloud(t,this.lang),t=this.lang)};for(var d=qTranslateConfig.enabled_languages,v={},h=0;h<d.length;h++){var m=d[h];v[m]=ce("input",{name:"qtranx_term_"+m,className:"hidden",value:name[m]||""},r,!0)}return i.onblur=function(){var e=languageSwitch.getActiveLanguage();v[e].value=this.value,s[e]=this.value,e===qTranslateConfig.default_language&&(o.value=this.value)},!0}function n(){function a(e){var a=ge("view-post-btn");if(a&&a.children.length){var n=a.children[0];n.urlWasGet||(u=ce("a",{href:n.href}),n.urlWasGet=!0);var t=ce("a",{href:u.href});switch(qTranslateConfig.url_mode.toString()){case"1":var i=t.host;t.search?t.search+="&lang="+e:t.search="?lang="+e;break;case"2":var i=t.host+"/"+e;t.pathname="/"+e+t.pathname;break;case"3":var i=e+"."+t.host;t.host=i}i=t.protocol+"//"+i+"/";var r=ge("sample-permalink"),l=ge("editable-post-name");r&&r.childNodes.length&&(r.childNodes[0].nodeValue=l?i:t.href),a&&a.children.length&&(a.children[0].href=t.href);var g=ge("preview-action");g&&g.children.length&&(g.children[0].href=t.href)}}function n(a){console.assert(a);var n=a.id;n&&(h[n]||(h[n]=!0,a.getBody().addEventListener("blur",function(){e(c,tinyMCE.activeEditor.getContent(),o,languageSwitch.getActiveLanguage())})))}var i=ge("post"),r=ge("content"),l=ge("title");if(!r||!l)return!1;var g=qtranxj_split(l.value),o=qtranxj_split(r.value),s=ce(l.tagName,{name:l.name,className:"hidden",value:l.value},i,!0),c=ce(r.tagName,{name:r.name,className:"hidden",value:r.value},i,!0);l.name+="_old",r.name+="_old",l.value=g[t],r.value=o[t];var u;a(t),onTabSwitch=function(){l.value=g[this.lang],r.value=o[this.lang],a(this.lang),window.tinyMCE&&tinyMCE.activeEditor&&tinyMCE.activeEditor.setContent(r.value)};var h={};return l.onblur=function(){e(s,this.value,g,languageSwitch.getActiveLanguage())},r.onblur=function(){e(c,this.value,o,languageSwitch.getActiveLanguage())},window.addEventListener("load",function(){return window.tinyMCE?(tinyMCE.autosave_ask_before_unload=!1,tinyMCE.activeEditor&&n(tinyMCE.activeEditor),void(tinyMCEPreInit.mceInit.content.init_instance_callback=function(e){n(e)})):void alert("qTranslate-X error: !window.tinyMCE. Please report this incident to the developers.")}),!0}var t=qtranxj_get_cookie("qtranx_edit_language");t||(t=qTranslateConfig.default_language),setLangCookie=function(){document.cookie="qtranx_edit_language="+this.lang};var i=location.pathname.match(/(\/wp-admin\/([^\/]*))$/);switch(i&&i[1]){case"/wp-admin/post.php":case"/wp-admin/post-new.php":if(!n())return;break;case"/wp-admin/edit-tags.php":if(!a())return;break;default:return}var r=ce("ul",{className:"qtranxs-lang-switch-wrap"}),l=document.getElementsByClassName("wrap")[0],g=l.getElementsByTagName("form")[0];g.parentNode.insertBefore(r,g),languageSwitch=new LanguageSwitch(r,t),languageSwitch.onSwitch(onTabSwitch),languageSwitch.onSwitch(setLangCookie)};new qTranslateX;