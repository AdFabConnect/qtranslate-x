function qtranxj_get_cookie(e){for(var a=e+"=",n=document.cookie.split(";"),t=0;t<n.length;t++){var i=n[t],r=i.indexOf(a);if(r>=0)return i.substring(r+a.length,i.length)}return""}function qtranxj_isArray(e){return e.constructor.toString().indexOf("Array")>=0}function ce(e,a,n,t){var i=document.createElement(e);if(a)for(prop in a)i[prop]=a[prop];return n&&(t&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i)),i}function c(e){++cc,console.log("== "+cc+": "+e)}function ct(e){c(e),console.trace()}function ge(e){return document.getElementById(e)}function LanguageSwitch(e,a){function n(){var e=this;if(!e.lang)return void alert("qTranslate-X: This should not have happened: Please, report this incident to the developers: !tabSwitch.lang");if(r!==e.lang){r&&l[r].classList.remove("active"),r=e.lang,e.classList.add("active");for(var a=0;a<g.length;a++)g[a].call(this)}}for(var t=qTranslateConfig.enabled_languages,i=qTranslateConfig.language_name,r=a,l={},g=[],s=0;s<t.length;s++){var o=t[s],c=ce("li",{lang:o,className:"qtranxs-lang-switch",onclick:n},e);ce("img",{src:"/wp-content/"+qTranslateConfig.flag_location+qTranslateConfig.flag[o]},c),ce("span",{innerHTML:i[o]},c),l[o]=c,r==o&&c.classList.add("active")}this.getActiveLanguage=function(){return r},this.onSwitch=function(e){"function"==typeof e&&g.push(e)}}qtranxj_split=function(e){for(var a=/(<!--.*?-->)/gi,n=/<!--:([a-z]{2})-->/gi,t=/<!--:-->/gi,i=/(<!--more-->|<!--nextpage-->)+$/gi,r=null,l=new Object,g=!1,s=0;s<qTranslateConfig.enabled_languages.length;s++){var o=qTranslateConfig.enabled_languages[s];l[o]=""}var c=e.xsplit(a);if(qtranxj_isArray(c))for(var s=0;s<c.length;s++)if(null!=(r=n.exec(c[s])))g=r[1];else if(t.test(c[s]))g=!1;else if(g)l[g]+=c[s];else for(var u=0;u<qTranslateConfig.enabled_languages.length;u++){var o=qTranslateConfig.enabled_languages[u];l[o]+=c[s]}for(var s=0;s<l.length;s++)l[s]=l[s].replace(i,"");return l},qtranxj_join=function(e){for(var a="",n=0;n<qTranslateConfig.enabled_languages.length;n++){var t=qTranslateConfig.enabled_languages[n],i=e[t];i&&""!=i&&(a+="<!--:"+t+"-->",a+=i,a+="<!--:-->")}return a},String.prototype.xsplit=function(e){if(3==="a~b".split(/(~)/).length)return this.split(e);e.global||(e=new RegExp(e.source,"g"+(e.ignoreCase?"i":"")));for(var a,n=0,t=[];null!=(a=e.exec(this));)t.push(this.slice(n,a.index)),a.length>1&&t.push(a[1]),n=e.lastIndex;return n<this.length&&t.push(this.slice(n)),n==this.length&&t.push(""),t};var cc=0,qTranslateX=function(){function e(e,a,n,t){var i=/(<!--more-->|<!--nextpage-->)+$/gi;n[t]=a.replace(i,""),e.value=qtranxj_join(n)}function a(){var e,a,n=!!ge("tag-name");n?(e="tag-",a="addtag"):(e="",a="edittag");var i=ge(e+"name"),r=ge(a);if(!r||!i)return!1;build_translator=function(e,a){var n={};for(var t in qTranslateConfig.term_name){var i=qTranslateConfig.term_name[t],r=i[e],l=i[a];if(!r||!l){var g=i[qTranslateConfig.default_language];if(!g)continue;r||(r=g+"("+qTranslateConfig.default_language+")"),l||(l=g+"("+qTranslateConfig.default_language+")")}n[r]=l}return n};var l=ge("the-list");(updateNames=function(e,a){if(l)for(var n=l.getElementsByTagName("TR"),t=0;t<n.length;t++){for(var i,r=n[t],g=r.getElementsByTagName("TD")[0],s=g.getElementsByTagName("DIV"),o=0;o<s.length;o++){var c=s[o];if("name"===c.className){i=c.innerHTML;break}}for(var u=qTranslateConfig.term_name[i]||{},h=u[e]||"",f=u[a]||"",v=g.getElementsByClassName("row-title"),d=0;d<v.length;d++){var c=v[d];h?c.innerHTML=c.innerHTML.replace(h,f):c.innerHTML+=f}}})(qTranslateConfig.default_language,t);var g=document.getElementsByClassName("tagcloud")[0];(updateTagCloud=function(e,a){if(g){var n=g.getElementsByTagName("A");if(n.length)for(var t=build_translator(e,a),i=0;i<n.length;i++){var r=n[i],l=r.innerHTML,s=t[l];s&&(r.innerHTML=s)}}})(qTranslateConfig.default_language,t);var s=ce("input",{name:i.name,className:"hidden",value:i.value},r,!0);i.name="";var o=qTranslateConfig.term_name[i.value]||{};t!==qTranslateConfig.default_language&&(i.value=o[t]||""),editinline_activated=function(){return c("editinline_activated:"+this.innerHTML),!0};var u=document.getElementsByClassName("editinline");c("editinlines.length="+u.length);for(var h=0;h<u.length;h++){var f=u[h];"A"===f.tagName&&f.addEventListener("click",editinline_activated)}onTabSwitch=function(){t!==this.lang&&(i.value=o[this.lang]||"",updateNames(t,this.lang),updateTagCloud(t,this.lang),t=this.lang)};for(var v=qTranslateConfig.enabled_languages,d={},h=0;h<v.length;h++){var m=v[h];d[m]=ce("input",{name:"qtranx_term_"+m,className:"hidden",value:name[m]||""},r,!0)}return i.onblur=function(){var e=languageSwitch.getActiveLanguage();d[e].value=this.value,o[e]=this.value,e===qTranslateConfig.default_language&&(s.value=this.value)},!0}function n(){function a(e){var a=ge("view-post-btn");if(a&&a.children.length){var n=a.children[0];n.urlWasGet||(v=ce("a",{href:n.href}),n.urlWasGet=!0);var t=ce("a",{href:v.href});switch(qTranslateConfig.url_mode.toString()){case"1":var i=t.host;t.search?t.search+="&lang="+e:t.search="?lang="+e;break;case"2":var i=t.host+"/"+e;t.pathname="/"+e+t.pathname;break;case"3":var i=e+"."+t.host;t.host=i}i=t.protocol+"//"+i+"/";var r=ge("sample-permalink"),l=ge("editable-post-name");r&&r.childNodes.length&&(r.childNodes[0].nodeValue=l?i:t.href),a&&a.children.length&&(a.children[0].href=t.href);var g=ge("preview-action");g&&g.children.length&&(g.children[0].href=t.href)}}function n(a){console.assert(a);var n=a.id;n&&(d[n]||(d[n]=!0,a.getBody().addEventListener("blur",function(){e(o,tinyMCE.activeEditor.getContent(),s,languageSwitch.getActiveLanguage())})))}var i,r,l=ge("post"),g=ge("title");if(!g)return!1;i=qtranxj_split(g.value),r=ce(g.tagName,{name:g.name,className:"hidden",value:g.value},l,!0),g.name+="_edit",g.value=i[t],g.onblur=function(){e(r,this.value,i,languageSwitch.getActiveLanguage())};var s,o,c=ge("content");c||(c=ge("attachment_content")),c&&(s=qtranxj_split(c.value),o=ce(c.tagName,{name:c.name,className:"hidden",value:c.value},l,!0),c.name+="_edit",c.value=s[t],c.onblur=function(){e(o,this.value,s,languageSwitch.getActiveLanguage())});var u,h,f=ge("attachment_caption");f&&(u=qtranxj_split(f.value),h=ce(f.tagName,{name:f.name,className:"hidden",value:f.value},l,!0),f.name+="_edit",f.value=u[t],f.onblur=function(){e(h,this.value,u,languageSwitch.getActiveLanguage())});var v;a(t),onTabSwitch=function(){g.value=i[this.lang],c.value=s[this.lang],f&&(f.value=u[this.lang]),a(this.lang),window.tinyMCE&&tinyMCE.activeEditor&&tinyMCE.activeEditor.setContent(c.value)};var d={};return window.addEventListener("load",function(){window.tinyMCE&&(tinyMCE.autosave_ask_before_unload=!1,tinyMCE.activeEditor&&n(tinyMCE.activeEditor),tinyMCEPreInit.mceInit.content.init_instance_callback=function(e){n(e)})}),!0}var t=qtranxj_get_cookie("qtranx_edit_language");t||(t=qTranslateConfig.default_language),setLangCookie=function(){document.cookie="qtranx_edit_language="+this.lang};var i=location.pathname.match(/(\/wp-admin\/([^\/]*))$/);switch(i&&i[1]){case"/wp-admin/post.php":case"/wp-admin/post-new.php":if(!n())return;break;case"/wp-admin/edit-tags.php":if(!a())return;break;default:return}var r=ce("ul",{className:"qtranxs-lang-switch-wrap"}),l=document.getElementsByClassName("wrap")[0],g=l.getElementsByTagName("form")[0];g.parentNode.insertBefore(r,g),languageSwitch=new LanguageSwitch(r,t),languageSwitch.onSwitch(onTabSwitch),languageSwitch.onSwitch(setLangCookie)};new qTranslateX;